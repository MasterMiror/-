#操作系统课程学习笔记

##C1 操作系统呢概述

常用四大操作系统：Win Mac Linux Unix

###操作系统的基本功能

  提供操作界面

  控制程序运行

  管理系统资源

  配置系统参数

  监控系统状态

  工具软件集合

###操作系统的功能

  进程管理（CPU管理）[控制、调度、通信]

  内存管理[内存分配 内存共享 内存保护 虚拟内存]

  设备管理[设备的分配和调度 设备传输控制 设备驱动]

  文件管理[存储空间管理 文件的操作 目录的操作 文件和目录的存取权限管理]

##Def操作系统是一个大型系统程序，它负责给用户提供接口，方便用户控制计算机；负责为应用程序分配和调度软硬件资源，并且控制程序的并发活动，帮助用户存取和保护信息。

系统程序在层次上处于应用程序和硬件之间的部分。


###操作系统的发展历程

  电子管时代

  晶体管时代

  集成电路时代

  大规模集成电路时代

###操作系统发展的四个典型阶段

  手工操作（无操作系统阶段）

  单道批处理系统

  多道批处理系统

  分时系统

###分时技术

由于多道批处理系统存在作业处理时间长、交互能力差等等缺点，在60年代基于中断技术和通道技术的出现而发展出了分时操作系统
它的交互性更高、响应更加快速，也支持多用户多任务。主机采用分时技术轮流为每个使用串口线接入主机的终端提供服务，对于每个终端来说都认为自己是独占主机的。

###分时技术的概念

  主机以很短的时间片（50ms）为单位，把cpu轮流分配给每个终端使用，直到全部作业被运行完。由于时间片非常短，在终端数量不多的情况下，每个终端都能重新获得CPU，使得每个终端都能获得及时响应。

  等待周期==时间片x终端数量

  大型分时系统的一种时间Multics项目。

  Unix是第一个实用化的分时系统，它的创新之处在于其可移植性和硬件无关性。它引入了“特殊文件”这一概念，将外设看作一种文件对外设进行统一管理。


###操作系统的典型案例

*微机操作系统* CP/M MacOS DOS Windows

*实时操作系统* 火控 雷达 跟踪识别等等系统

*网络操作系统* 普通操作系统+网络通信+网络服务



=======================================================
#C2操作系统逻辑结构

##分层的操作系统

    资源分配与调度
        ｜｜
        ｜｜
      文件存取
        ｜｜
        ｜｜
      I/O处理
        ｜｜
        ｜｜
      存储管理
        ｜｜
        ｜｜
      进程管理
  初级中断管理/裸机/处理机分派

##分层的原则

硬件相关————最底层

外部特征————最外层

中间层————调用次序或消息传递顺序

共性的服务————较低层

活跃功能————较低层

分层的有点是：1结构清晰，避免循环调用；2.容易将问题局部化，系统的正确性容易保证；3.有利于系统的维护、扩充、移植。

##微内核结构

操作系统 == 微内核 + 核外服务器

微内核（足够小，提供OS最基本的核心功能和服务）

核外服务器 （能完成OS大部分的服务功能，等待App提出请求）

相关项目可以参考Linux和Minix


##操作系统的逻辑结构

CPU的态 即CPU的工作状态，对资源和权限使用指令的描述。

态可分为：核态（Kernel mode 可访问所有资源和执行所有指令）；用户态（User mode 仅可以访问部分资源，其他资源受限）；管态(Supervisor mode 介于核态和用户态之间)

用户态在以下四种情况发生时可向核态转换：

1.请求OS服务

2.中断发生

3.Error

4.企图执行特权指令

核态向用户态转移的情况一般是执行中断返回：IRET

硬件按“态”来区分CPU的咋混改

OS按“进程”来区分CPU的状态

##存储器

###存储器的分类：

1.按读写方式可分为RAM和ROM

2.按存储材料可分为半导体存储器、磁存储器、光存储器

3.按和CPU的联系可分为主存和辅存

一个理想的储存体系应该应对不同的存储需求有不同的成本和架构，它的大致要求是速度快、容量大、成本低


##CPU读取指令互数据时的访问顺序：

1.访问缓存

2.访问内存

3.访问辅存

##中断

###定义 中断即CPU对突发的外部事件的反应过程或者机制（CPU收到外部信号之后停止当前工作去处理外部事件，随后回到原来的中断点继续工作）

引入中断的目的在于实现并发、实现实时处理、实现故障的自动处理

引起中断的事件被称为中断源，中断分为强迫性中断和自愿中断。也可分为外中断和内中断，外中断由CPU外部事件引发，内中断相反；外中断又分为可屏蔽和不可屏蔽，依据是CPU是否可以不响应。

断点：即程序中断的地方 CS:IP

现场：程序正确运行所依赖的信息集合。

##中断响应的过程：

1.识别中断源

2.保护断点和现场

3.装入中断服务程序的入口地址（CS:IP）

4.装入中断服务程序

5.恢复现场和断点

6.中断返回：IRET

##中断响应的实质是交换指令执行地址和交换CPU的态


=======================================================
